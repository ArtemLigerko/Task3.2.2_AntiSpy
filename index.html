<!DOCTYPE html>
<html>
<body>

<h1>AntiSpy</h1>

<script>
    

    const text = "If you agree with that, just let me know to obama@mail.us or newpower@gmail.com and I'll reach out as soon as possible.";

    console.log(text);
    console.log(antiSpy(text, "XXXXX"));

    function antiSpy (text, hideMail) {
        let k = 0;
        let pos;
        let textAntiSpy = "";
        

        if (hideMail == null) {
            hideMail = "HIDDEN_DATA";
        } 


        while (pos != -1) {

            pos = text.indexOf("@", k);     
            posMailStart = text.lastIndexOf(" ", pos) + 1;
            posMailEnd = text.indexOf(" ", posMailStart);
            // console.log(posMailStart, pos, posMailEnd);
            // console.log(text.slice(posMailStart, posMailEnd));

            textAntiSpy = textAntiSpy 
            + text.slice(k, posMailStart) 
            + hideMail; 
            
            pos = text.indexOf("@", posMailEnd);
            k = posMailEnd;

            // console.log(textAntiSpy);        
        }

        textAntiSpy = textAntiSpy 
        + text.slice(posMailEnd, text.length);

        return textAntiSpy;
    }

</script>



</body>
</html>